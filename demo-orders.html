<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Demo ADD Orders ‚Äì Restaurante / pedidos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Demo ADD Orders: as√≠ se ve un flujo de pedidos claros y pagos adelantados para restaurantes, food trucks y dark kitchens." />
  <style>
    :root {
      --bg: #050509;
      --bg-alt: #0b0b12;
      --card: #11111a;
      --accent: #fbbf24;
      --accent-soft: rgba(251,191,36,0.15);
      --accent-strong: #f59e0b;
      --text: #f9fafb;
      --text-soft: #9ca3af;
      --border-subtle: #1f2933;
      --danger: #f97373;
      --success: #22c55e;
      --radius-xl: 24px;
      --radius-lg: 18px;
      --radius-pill: 999px;
      --shadow-soft: 0 18px 40px rgba(0,0,0,0.55);
      --transition-fast: 0.18s ease-out;
    }

    * { box-sizing:border-box; margin:0; padding:0; }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #111827 0, #02030a 45%, #02030a 100%);
      color: var(--text);
      line-height: 1.5;
    }

    a { color: inherit; text-decoration: none; }

    .page {
      max-width: 960px;
      margin: 0 auto;
      padding: 24px 16px 48px;
    }

    /* HEADER DEMO */
    .demo-header {
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:24px;
      gap:12px;
    }

    .demo-logo {
      display:flex;
      align-items:center;
      gap:10px;
    }

    .logo-mark {
      width:40px; height:40px;
      border-radius:20px;
      background: radial-gradient(circle at 30% 0%, #facc15, #38bdf8 45%, #020617 100%);
      display:flex; align-items:center; justify-content:center;
      font-weight:800; font-size:20px;
      box-shadow:var(--shadow-soft);
    }

    .demo-logo-text-title {
      font-size:15px;
      font-weight:650;
    }

    .demo-logo-text-sub {
      font-size:11px;
      color:var(--text-soft);
      text-transform:uppercase;
      letter-spacing:.14em;
    }

    .demo-header-right {
      display:flex;
      align-items:center;
      gap:8px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .demo-tag {
      font-size:11px;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(249,250,251,0.18);
      color:var(--text-soft);
      white-space:nowrap;
      background:rgba(15,23,42,0.85);
    }

    .btn {
      border-radius: var(--radius-pill);
      border: none;
      font-size: 13px;
      padding: 9px 18px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-weight: 500;
      white-space: nowrap;
      text-decoration:none;
      transition: transform var(--transition-fast), box-shadow var(--transition-fast), background var(--transition-fast), color var(--transition-fast), border-color var(--transition-fast), opacity var(--transition-fast);
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--accent), var(--accent-strong));
      color:#020617;
      box-shadow:0 14px 30px rgba(248,181,26,0.45);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow:0 20px 40px rgba(248,181,26,0.55);
    }

    .btn-outline {
      background:transparent;
      color:var(--text-soft);
      border:1px solid rgba(148,163,184,0.4);
    }

    .btn-outline:hover {
      border-color:var(--accent);
      color:var(--accent);
      transform:translateY(-1px);
    }

    .btn-back span {
      font-size:14px;
      margin-right:2px;
    }

    /* HERO */
    .demo-hero {
      margin-bottom:24px;
    }

    .demo-title {
      font-size:26px;
      margin-bottom:6px;
      letter-spacing:-0.02em;
    }

    .demo-title strong {
      background: linear-gradient(to right, #facc15, #38bdf8);
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
    }

    .demo-sub {
      font-size:14px;
      color:var(--text-soft);
      max-width:620px;
    }

    .demo-sub strong {
      color:var(--accent);
      font-weight:600;
    }

    /* PASOS */
    .steps {
      display:flex;
      gap:10px;
      margin-top:16px;
      margin-bottom:8px;
      flex-wrap:wrap;
    }

    .step {
      display:flex;
      align-items:center;
      gap:8px;
      font-size:12px;
      color:var(--text-soft);
      padding:6px 11px;
      border-radius:999px;
      border:1px solid rgba(31,41,55,0.9);
      background:rgba(15,23,42,0.85);
      transition: border-color var(--transition-fast), background var(--transition-fast), color var(--transition-fast), box-shadow var(--transition-fast), transform var(--transition-fast);
    }

    .step-badge {
      width:20px; height:20px;
      border-radius:999px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:12px;
      font-weight:650;
      background:#020617;
      color:var(--text-soft);
    }

    .step.active {
      border-color:var(--accent);
      color:var(--accent);
      box-shadow:0 0 0 1px rgba(248,181,26,0.25);
    }

    .step.active .step-badge {
      background:var(--accent);
      color:#020617;
    }

    .step.done {
      border-color:var(--success);
      background:rgba(22,163,74,0.18);
      color:var(--success);
      box-shadow:0 0 0 1px rgba(34,197,94,0.35);
      transform:translateY(-1px);
    }

    .step.done .step-badge {
      background:var(--success);
      color:#020617;
    }

    /* LAYOUT PRINCIPAL */
    .demo-grid {
      display:grid;
      grid-template-columns: minmax(0,1.2fr) minmax(0,1fr);
      gap:16px;
      margin-top:18px;
    }

    .card {
      background:var(--bg-alt);
      border-radius:var(--radius-xl);
      border:1px solid var(--border-subtle);
      padding:16px;
      box-shadow:var(--shadow-soft);
    }

    .card-title {
      font-size:15px;
      font-weight:600;
      margin-bottom:8px;
    }

    .card-sub {
      font-size:13px;
      color:var(--text-soft);
      margin-bottom:10px;
    }

    .field-group {
      display:flex;
      flex-direction:column;
      gap:9px;
      font-size:12px;
      color:var(--text-soft);
    }

    .field-group label {
      display:flex;
      flex-direction:column;
      gap:4px;
    }

    .field-group input,
    .field-group select,
    .field-group textarea {
      padding:7px 9px;
      border-radius:9px;
      border:1px solid var(--border-subtle);
      background:#020617;
      color:var(--text);
      font-size:13px;
      resize:vertical;
      min-height:34px;
      outline:none;
      transition:border-color var(--transition-fast), box-shadow var(--transition-fast), background var(--transition-fast);
    }

    .field-group input:focus,
    .field-group select:focus,
    .field-group textarea:focus {
      border-color:var(--accent);
      box-shadow:0 0 0 1px rgba(248,181,26,0.35);
      background:#020617;
    }

    .field-inline {
      display:flex;
      gap:8px;
      flex-wrap:wrap;
    }

    .field-inline > label {
      flex:1 1 140px;
    }

    .status {
      font-size:11px;
      margin-top:6px;
      color:var(--text-soft);
    }

    .status.success {
      color:var(--success);
    }

    .status.error {
      color:var(--danger);
    }

    .product-meta {
      font-size:11px;
      color:var(--text-soft);
      margin-top:3px;
    }

    .product-meta strong {
      color:var(--accent);
      font-weight:500;
    }

    .chip-row {
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:5px;
      font-size:10px;
    }

    .chip {
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.5);
      color:var(--text-soft);
    }

    .chip.special {
      border-color:rgba(248,181,26,0.7);
      color:var(--accent);
    }

    .extras-group {
      display:grid;
      grid-template-columns:repeat(2,minmax(0,1fr));
      gap:4px 10px;
      margin-top:4px;
      font-size:11px;
    }

    .extra-item {
      display:flex;
      align-items:center;
      gap:6px;
    }

    .extra-item input {
      width:auto;
      min-height:auto;
    }

    /* COLUMNA DERECHA */
    .side-column {
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .summary-row {
      display:flex;
      justify-content:space-between;
      font-size:12px;
      margin-bottom:4px;
    }

    .summary-row span:last-child {
      font-weight:600;
    }

    .summary-row-muted {
      font-size:11px;
      color:var(--text-soft);
    }

    .price-highlight {
      font-size:20px;
      font-weight:700;
    }

    .delivery-text {
      font-size:11px;
      color:var(--accent);
      margin-top:2px;
    }

    .payment-methods {
      margin-top:10px;
      font-size:11px;
      color:var(--text-soft);
    }

    .payment-tags {
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:4px;
    }

    .payment-tag {
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.5);
      font-size:10px;
    }

    .whatsapp-preview {
      font-size:12px;
      background:#020617;
      border-radius:12px;
      padding:10px;
      border:1px solid var(--border-subtle);
      color:var(--text-soft);
      white-space:pre-wrap;
    }

    .badge-demo {
      display:inline-flex;
      align-items:center;
      gap:4px;
      font-size:10px;
      color:var(--text-soft);
      margin-bottom:6px;
    }

    .badge-demo span {
      width:8px;
      height:8px;
      border-radius:999px;
      background:var(--accent);
    }

    /* CTA FINAL ANUNCIO */
    .cta-final {
      margin-top:26px;
      padding:18px 18px 16px;
      border-radius:26px;
      border:1px solid rgba(56,189,248,0.65);
      background:
        radial-gradient(circle at top left, rgba(56,189,248,0.16), transparent 55%),
        radial-gradient(circle at top right, rgba(251,191,36,0.18), transparent 55%),
        #020617;
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      font-size:13px;
      color:var(--text-soft);
      box-shadow:0 22px 55px rgba(0,0,0,0.75);
      position:relative;
      overflow:hidden;
    }

    .cta-final::before {
      content:"CENTRO DE CONTROL DE PEDIDOS";
      position:absolute;
      top:10px;
      right:-40px;
      font-size:10px;
      letter-spacing:.22em;
      text-transform:uppercase;
      color:rgba(148,163,184,0.25);
      transform:rotate(-12deg);
    }

    .cta-copy-strong {
      font-size:15px;
      font-weight:650;
      color:var(--text);
      margin-bottom:4px;
    }

    .cta-highlight {
      color:var(--accent);
      font-weight:600;
    }

    .cta-mini {
      font-size:11px;
      color:var(--text-soft);
      margin-top:3px;
    }

    .cta-pill {
      font-size:11px;
      padding:4px 9px;
      border-radius:999px;
      border:1px solid rgba(56,189,248,0.6);
      color:#bae6fd;
      background:rgba(15,23,42,0.9);
      margin-top:4px;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }

    .cta-pill-dot {
      width:7px;
      height:7px;
      border-radius:999px;
      background:#22c55e;
    }

    .cta-price {
      font-size:11px;
      color:var(--text-soft);
      margin-top:2px;
    }

    .cta-price strong {
      color:var(--accent);
    }

    @media (max-width:840px){
      .demo-header{flex-direction:column; align-items:flex-start;}
      .demo-header-right{justify-content:flex-start;}
      .demo-grid{grid-template-columns:minmax(0,1fr);}
      .cta-final{flex-direction:column; align-items:flex-start;}
    }
  </style>
</head>
<body>
  <main class="page">
    <!-- HEADER DEMO -->
    <header class="demo-header">
      <div class="demo-logo">
        <div class="logo-mark">A</div>
        <div>
          <div class="demo-logo-text-title">ADD Systems</div>
          <div class="demo-logo-text-sub">Demo ADD Orders ‚Äì Restaurante</div>
        </div>
      </div>
      <div class="demo-header-right">
        <div class="demo-tag">Simulaci√≥n real de pedido + pago (modo demo)</div>
        <a href="index.html" class="btn btn-outline btn-back">
          <span>‚Üê</span> Volver a la p√°gina anterior
        </a>
      </div>
    </header>

    <!-- HERO / PASOS -->
    <section class="demo-hero">
      <h1 class="demo-title">
        As√≠ se ver√≠a tu <strong>sistema de pedidos</strong> con ADD Orders.
      </h1>
      <p class="demo-sub">
        Desde el punto de vista del cliente: elige plato, extras, modalidad y hora. Desde tu lado:
        recibes un pedido <strong>estructurado y calculado</strong>, listo para cobrar y pasar a cocina
        sin notas de voz ni mensajes rotos.
      </p>

      <div class="steps" id="steps">
        <div class="step active" data-step="1">
          <div class="step-badge">1</div>
          Elige el pedido
        </div>
        <div class="step" data-step="2">
          <div class="step-badge">2</div>
          Datos de entrega / recogida
        </div>
        <div class="step" data-step="3">
          <div class="step-badge">3</div>
          Pago y confirmaci√≥n
        </div>
      </div>

      <div class="demo-grid">
        <!-- IZQUIERDA: FORM -->
        <article class="card">
          <h2 class="card-title">Configura un pedido demo</h2>
          <p class="card-sub">
            Completa este ejemplo como si fueras tu cliente. ADD Orders calcula subtotal, delivery,
            propina y genera un mensaje listo para WhatsApp o tu panel interno.
          </p>

          <form id="demo-order-form" class="field-group" novalidate>
            <label>
              Nombre del cliente
              <input name="nombre" required placeholder="Ej: Laura G√≥mez" />
            </label>

            <label>
              Plato principal
              <select name="plato" id="plato-select">
                <option value="smash">Smash Burger Doble ‚Äì ‚ÄúHouse Signature‚Äù</option>
                <option value="wings">Combo Wings + Papas ‚Äì Salsa Signature</option>
                <option value="tacos">Tacos Mixtos ‚Äì 3 unidades</option>
                <option value="bowl">Urban Chicken Bowl ‚Äì Fit / High Protein</option>
              </select>
            </label>

            <div id="product-meta" class="product-meta">
              Tiempo aprox.: <strong>15‚Äì18 min</strong> ¬∑ Nivel: Smash burger callejera ¬∑
              Incluye: doble carne, queso americano, pan brioche tostado.
            </div>

            <div class="chip-row">
              <div class="chip">Pan brioche</div>
              <div class="chip">Carne smash 80/20</div>
              <div class="chip">Cebolla caramelizada</div>
              <div class="chip special">Salsa de la casa (signature)</div>
            </div>

            <div class="field-inline">
              <label>
                Cantidad
                <input type="number" name="cantidad" id="cantidad-input" min="1" value="1" />
              </label>
              <label>
                Nivel de picante
                <select name="picante">
                  <option value="Suave">Suave</option>
                  <option value="Medio">Medio</option>
                  <option value="Alto">Alto</option>
                </select>
              </label>
            </div>

            <label>
              Extras (demo)
              <div class="extras-group">
                <label class="extra-item">
                  <input type="checkbox" name="extra_queso" value="1" />
                  Queso extra (+$1.50)
                </label>
                <label class="extra-item">
                  <input type="checkbox" name="extra_bacon" value="1" />
                  Bacon crispy (+$2.00)
                </label>
                <label class="extra-item">
                  <input type="checkbox" name="extra_papas" value="1" />
                  Papas grandes upgrade (+$2.50)
                </label>
                <label class="extra-item">
                  <input type="checkbox" name="extra_drink" value="1" />
                  Bebida premium (+$2.00)
                </label>
              </div>
            </label>

            <div class="field-inline">
              <label>
                Modalidad
                <select name="modalidad" id="modalidad-select">
                  <option value="pickup">Recoger en el local</option>
                  <option value="delivery">Delivery</option>
                </select>
              </label>
              <label id="zona-wrapper">
                Zona de entrega (demo)
                <select name="zona" id="zona-select">
                  <option value="cerca">Zona cercana (hasta 3 mi)</option>
                  <option value="media">Zona media (3‚Äì7 mi)</option>
                  <option value="lejos">Zona extendida (7‚Äì10 mi)</option>
                </select>
              </label>
            </div>

            <div class="field-inline">
              <label>
                Hora aproximada
                <input type="time" name="hora" />
              </label>
              <label>
                WhatsApp de contacto
                <input name="whatsapp" required placeholder="+1 ..." />
              </label>
            </div>

            <label>
              Notas (sin cebolla, extra salsa, indicaciones delivery...)
              <textarea name="notas" rows="2" placeholder="Ej: Sin cebolla, extra salsa de la casa, timbrar al llegar."></textarea>
            </label>

            <div class="field-inline">
              <label>
                M√©todo de pago (demo)
                <select name="pago" id="pago-select">
                  <option value="tarjeta">Tarjeta online (Stripe / Apple Pay)</option>
                  <option value="cashapp">Cash App / Zelle</option>
                  <option value="contra">Pago en efectivo al recibir</option>
                </select>
              </label>
              <label>
                ¬øPropina estimada?
                <select name="propina" id="propina-select">
                  <option value="0">Sin propina</option>
                  <option value="10">10%</option>
                  <option value="15">15%</option>
                  <option value="20">20%</option>
                </select>
              </label>
            </div>

            <button type="submit" class="btn btn-primary" style="align-self:flex-start; margin-top:8px;">
              Generar pedido demo completo
            </button>
            <p id="demo-status" class="status"></p>
          </form>
        </article>

        <!-- DERECHA: RESUMEN + WHATSAPP -->
        <div class="side-column">
          <article class="card">
            <h2 class="card-title">Resumen y total (modo demo)</h2>
            <p class="card-sub">
              As√≠ ver√≠as t√∫ el pedido en tu panel: detalle de platos, extras, delivery, propina y
              m√©todo de pago. Nada de notas de voz imposibles de revisar.
            </p>

            <div class="summary-row">
              <span>Plato:</span>
              <span id="summary-plato">Smash Burger Doble ‚Äì ‚ÄúHouse Signature‚Äù</span>
            </div>
            <div class="summary-row">
              <span>Cantidad:</span>
              <span id="summary-cantidad">1</span>
            </div>
            <div class="summary-row">
              <span>Extras:</span>
              <span id="summary-extras">Sin extras</span>
            </div>

            <hr style="border:none; border-top:1px dashed rgba(55,65,81,0.8); margin:10px 0;" />

            <div class="summary-row">
              <span>Subtotal comida:</span>
              <span id="summary-subtotal">$14.00</span>
            </div>
            <div class="summary-row">
              <span>Delivery (demo):</span>
              <span id="summary-delivery">$0.00</span>
            </div>
            <div class="summary-row">
              <span>Propina estimada:</span>
              <span id="summary-tip">$0.00</span>
            </div>
            <div class="summary-row">
              <span>Total estimado:</span>
              <span class="price-highlight" id="summary-total">$14.00</span>
            </div>
            <div class="delivery-text" id="delivery-text">
              Modalidad: recoger en el local. En delivery se agrega una tarifa seg√∫n zona.
            </div>

            <div class="payment-methods">
              M√©todo de pago seleccionado:
              <div class="summary-row summary-row-muted">
                <span id="summary-payment">Tarjeta online (Stripe / Apple Pay)</span>
                <span style="font-size:10px;">Vista demo</span>
              </div>
              <div class="payment-tags">
                <div class="payment-tag">Stripe</div>
                <div class="payment-tag">Apple Pay</div>
                <div class="payment-tag">Cash App</div>
                <div class="payment-tag">Zelle</div>
              </div>
            </div>
          </article>

          <article class="card">
            <h2 class="card-title">C√≥mo te llega el pedido por WhatsApp</h2>
            <p class="card-sub">
              Este es el tipo de mensaje estructurado que recibir√≠as: todo claro en un solo bloque,
              listo para aceptar, cobrar y pasar a cocina.
            </p>
            <div class="badge-demo">
              <span></span> Mensaje generado autom√°ticamente por ADD Orders (demo)
            </div>
            <div id="whatsapp-preview" class="whatsapp-preview">
Cliente: (aqu√≠ ver√°s el pedido listo, sin notas de voz ni mensajes rotos, cuando generes el pedido demo).
            </div>
          </article>
        </div>
      </div>

      <!-- CTA FINAL ANUNCIO -->
      <div class="cta-final">
        <div>
          <div class="cta-copy-strong">
            ¬øTe imaginas todos tus pedidos entrando as√≠ de claros cada noche?
          </div>
          ADD Orders se convierte en tu <span class="cta-highlight">centro de control de pedidos y entregas</span>:
          un solo enlace, un solo QR y todos tus canales ordenados (pedido directo, pickup y delivery).
          <div class="cta-mini">
            Dejas de depender solo de las apps de delivery, impulsas pedidos directos y mantienes Uber / DoorDash / Grubhub
            como apoyo, pero bajo tus reglas.
          </div>
          <div class="cta-pill">
            <span class="cta-pill-dot"></span>
            Menos caos en la cocina ¬∑ M√°s margen por pedido ¬∑ Pedidos listos para cobrar
          </div>
          <div class="cta-price">
            Desde <strong>$399 setup + mensualidad</strong> ¬∑ Enfocado en restaurantes reales, no en ‚Äúapps bonitas‚Äù.
          </div>
        </div>
        <a
          href="https://tidycal.com/tu-enlace-de-demo?notes=Interesado%20en%20ADD%20Orders%20(restaurante)"
          target="_blank"
          rel="noopener"
          class="btn btn-primary"
        >
          Quiero este centro de control en mi negocio
        </a>
      </div>
    </section>
  </main>

  <script>
    // Datos de men√∫: nombre, precio base, meta, chips
    var menuData = {
      smash: {
        nombre: "Smash Burger Doble ‚Äì ‚ÄúHouse Signature‚Äù",
        precio: 14,
        meta:
          'Tiempo aprox.: <strong>15‚Äì18 min</strong> ¬∑ Nivel: Smash callejera ¬∑ ' +
          "Incluye: doble carne, queso americano, pan brioche tostado.",
        chips: ["Pan brioche", "Carne smash 80/20", "Cebolla caramelizada", "Salsa de la casa (signature)"]
      },
      wings: {
        nombre: "Combo Wings + Papas ‚Äì Salsa Signature",
        precio: 16,
        meta:
          'Tiempo aprox.: <strong>18‚Äì22 min</strong> ¬∑ 10 wings + papas ¬∑ ' +
          "Salsas a elegir (BBQ, Buffalo, Honey Garlic, Spicy).",
        chips: ["10 wings crujientes", "Papas sazonadas", "Salsa a elecci√≥n", "Perfecto para compartir"]
      },
      tacos: {
        nombre: "Tacos Mixtos ‚Äì 3 unidades",
        precio: 12,
        meta:
          'Tiempo aprox.: <strong>12‚Äì15 min</strong> ¬∑ Tortilla ma√≠z / harina ¬∑ ' +
          "Mix de carne asada, pollo y pastor.",
        chips: ["Tortilla ma√≠z / harina", "Cilantro + cebolla", "Salsas caseras", "Opci√≥n sin queso"]
      },
      bowl: {
        nombre: "Urban Chicken Bowl ‚Äì Fit / High Protein",
        precio: 13,
        meta:
          'Tiempo aprox.: <strong>14‚Äì18 min</strong> ¬∑ Base arroz / quinoa ¬∑ ' +
          "Pollo grill, vegetales y toppings.",
        chips: ["Opci√≥n fit", "High protein", "Personalizable", "Ideal post-entreno"]
      }
    };

    // Precios extras
    var extrasPrices = {
      extra_queso: 1.5,
      extra_bacon: 2.0,
      extra_papas: 2.5,
      extra_drink: 2.0
    };

    // Precios delivery por zona
    var deliveryFees = {
      cerca: 3.0,
      media: 5.0,
      lejos: 7.0
    };

    var form = document.getElementById("demo-order-form");
    var statusEl = document.getElementById("demo-status");
    var preview = document.getElementById("whatsapp-preview");

    var platoSelect = document.getElementById("plato-select");
    var cantidadInput = document.getElementById("cantidad-input");
    var modalidadSelect = document.getElementById("modalidad-select");
    var zonaSelect = document.getElementById("zona-select");
    var pagoSelect = document.getElementById("pago-select");
    var propinaSelect = document.getElementById("propina-select");

    var productMetaEl = document.getElementById("product-meta");
    var chipsRow = document.querySelector(".chip-row");

    var summaryPlato = document.getElementById("summary-plato");
    var summaryCantidad = document.getElementById("summary-cantidad");
    var summaryExtras = document.getElementById("summary-extras");
    var summarySubtotal = document.getElementById("summary-subtotal");
    var summaryDelivery = document.getElementById("summary-delivery");
    var summaryTip = document.getElementById("summary-tip");
    var summaryTotal = document.getElementById("summary-total");
    var summaryPayment = document.getElementById("summary-payment");
    var deliveryText = document.getElementById("delivery-text");

    var stepsEls = document.querySelectorAll(".step");
    var step3Completed = false;

    function getSelectedExtras() {
      var extras = [];
      var totalExtras = 0;
      Object.keys(extrasPrices).forEach(function (key) {
        var input = form.querySelector('input[name="' + key + '"]');
        if (input && input.checked) {
          extras.push(key);
          totalExtras += extrasPrices[key];
        }
      });
      return { extras: extras, totalExtras: totalExtras };
    }

    function formateaExtrasLista(extrasArr) {
      if (!extrasArr.length) return "Sin extras";
      var etiquetas = {
        extra_queso: "Queso extra",
        extra_bacon: "Bacon crispy",
        extra_papas: "Papas grandes",
        extra_drink: "Bebida premium"
      };
      return extrasArr.map(function (key) { return etiquetas[key] || key; }).join(", ");
    }

    function actualizarPlato() {
      var key = platoSelect.value;
      var data = menuData[key] || menuData["smash"];

      productMetaEl.innerHTML = data.meta;
      summaryPlato.textContent = data.nombre;

      // chips
      chipsRow.innerHTML = "";
      (data.chips || []).forEach(function (ch, idx) {
        var div = document.createElement("div");
        div.className = "chip" + (idx === data.chips.length - 1 ? " special" : "");
        div.textContent = ch;
        chipsRow.appendChild(div);
      });

      actualizarResumen();
    }

    function actualizarDeliveryVisibilidad() {
      var isDelivery = modalidadSelect.value === "delivery";
      var zonaWrapper = document.getElementById("zona-wrapper");
      if (zonaWrapper) {
        zonaWrapper.style.opacity = isDelivery ? "1" : "0.45";
      }
    }

    function actualizarResumen() {
      var key = platoSelect.value;
      var data = menuData[key] || menuData["smash"];
      var cantidad = parseInt(cantidadInput.value || "1", 10);
      if (isNaN(cantidad) || cantidad < 1) cantidad = 1;

      var extrasInfo = getSelectedExtras();
      var extrasArr = extrasInfo.extras;
      var extrasPorUnidad = extrasInfo.totalExtras;

      var subtotal = (data.precio + extrasPorUnidad) * cantidad;

      var delivery = 0;
      var modalidad = modalidadSelect.value;
      var zona = zonaSelect.value || "cerca";

      if (modalidad === "delivery") {
        delivery = deliveryFees[zona] || deliveryFees["cerca"];
      }

      var propinaPct = parseInt(propinaSelect.value || "0", 10);
      if (isNaN(propinaPct)) propinaPct = 0;
      var tip = (subtotal * propinaPct) / 100;

      var total = subtotal + delivery + tip;

      summaryCantidad.textContent = cantidad.toString();
      summaryExtras.textContent = formateaExtrasLista(extrasArr);
      summarySubtotal.textContent = "$" + subtotal.toFixed(2);
      summaryDelivery.textContent = "$" + delivery.toFixed(2);
      summaryTip.textContent = "$" + tip.toFixed(2);
      summaryTotal.textContent = "$" + total.toFixed(2);

      if (modalidad === "delivery") {
        var zonaTxt = "zona cercana";
        if (zona === "media") zonaTxt = "zona media";
        if (zona === "lejos") zonaTxt = "zona extendida";
        deliveryText.textContent =
          "Delivery activo: tarifa demo seg√∫n " +
          zonaTxt +
          ". Estos valores se ajustan a tu radio real de entrega.";
        deliveryText.style.color = "#fbbf24";
      } else {
        deliveryText.textContent =
          "Modalidad: recoger en el local. En delivery se agrega una tarifa seg√∫n zona.";
        deliveryText.style.color = "#9ca3af";
      }

      var pagoValue = pagoSelect.value;
      var pagoText = "Tarjeta online (Stripe / Apple Pay)";
      if (pagoValue === "cashapp") pagoText = "Cash App / Zelle";
      if (pagoValue === "contra") pagoText = "Pago en efectivo al recibir";
      summaryPayment.textContent = pagoText;

      actualizarSteps();
    }

    function calcularEstadosSteps() {
      var data = new FormData(form);
      var nombre = (data.get("nombre") || "").trim();
      var plato = data.get("plato") || "";
      var cantidad = parseInt(data.get("cantidad") || "0", 10);

      var modalidad = data.get("modalidad") || "";
      var zona = data.get("zona") || "";
      var hora = (data.get("hora") || "").trim();
      var whatsapp = (data.get("whatsapp") || "").trim();

      var step1Done = !!(nombre && plato && cantidad >= 1);
      var step2Done = !!(
        whatsapp &&
        modalidad &&
        hora &&
        (modalidad !== "delivery" || zona)
      );

      return {
        step1Done: step1Done,
        step2Done: step2Done,
        step3Done: step3Completed
      };
    }

    function actualizarSteps() {
      var estados = calcularEstadosSteps();

      stepsEls.forEach(function (stepEl) {
        var n = parseInt(stepEl.getAttribute("data-step"), 10);
        var badge = stepEl.querySelector(".step-badge");
        var isDone =
          (n === 1 && estados.step1Done) ||
          (n === 2 && estados.step2Done) ||
          (n === 3 && estados.step3Done);

        stepEl.classList.remove("active", "done");
        if (badge) {
          badge.textContent = String(n);
        }

        if (isDone) {
          stepEl.classList.add("done");
          if (badge) badge.textContent = "‚úì";
        }
      });

      // Step activo = primer paso no completado (si todos, el 3)
      var activeStep = 1;
      if (estados.step1Done && !estados.step2Done) activeStep = 2;
      if (estados.step1Done && estados.step2Done && !estados.step3Done) activeStep = 3;
      if (estados.step3Done) activeStep = 3;

      stepsEls.forEach(function (stepEl) {
        var n = parseInt(stepEl.getAttribute("data-step"), 10);
        if (n === activeStep && !stepEl.classList.contains("done")) {
          stepEl.classList.add("active");
        }
      });
    }

    // Eventos de actualizaci√≥n
    if (platoSelect) {
      platoSelect.addEventListener("change", function () {
        actualizarPlato();
      });
    }

    if (cantidadInput) {
      cantidadInput.addEventListener("input", actualizarResumen);
    }

    if (modalidadSelect) {
      modalidadSelect.addEventListener("change", function () {
        actualizarDeliveryVisibilidad();
        actualizarResumen();
      });
    }

    if (zonaSelect) {
      zonaSelect.addEventListener("change", actualizarResumen);
    }

    if (pagoSelect) {
      pagoSelect.addEventListener("change", actualizarResumen);
    }

    if (propinaSelect) {
      propinaSelect.addEventListener("change", actualizarResumen);
    }

    // Extras
    Object.keys(extrasPrices).forEach(function (key) {
      var input = form.querySelector('input[name="' + key + '"]');
      if (input) {
        input.addEventListener("change", actualizarResumen);
      }
    });

    // Cualquier cambio en el formulario ‚Üí revisar pasos
    if (form) {
      form.addEventListener("input", actualizarSteps);
      form.addEventListener("change", actualizarSteps);
    }

    // Submit ‚Üí genera mensaje WhatsApp y marca paso 3
    if (form && statusEl && preview) {
      form.addEventListener("submit", function (e) {
        e.preventDefault();
        var data = Object.fromEntries(new FormData(form).entries());

        // Validaciones m√≠nimas
        if (!data.nombre || !data.whatsapp) {
          statusEl.className = "status error";
          statusEl.textContent = "Completa al menos nombre y WhatsApp para generar el pedido demo.";
          return;
        }

        var key = data.plato || "smash";
        var mData = menuData[key] || menuData["smash"];
        var cantidad = parseInt(data.cantidad || "1", 10);
        if (isNaN(cantidad) || cantidad < 1) cantidad = 1;

        var extrasInfo = getSelectedExtras();
        var extrasArr = extrasInfo.extras;
        var extrasText = formateaExtrasLista(extrasArr);

        var modalidad = data.modalidad === "delivery" ? "Delivery" : "Recoger en el local";
        var zona = data.zona || "Zona cercana (demo)";
        var hora = data.hora || "Lo antes posible";
        var nombre = data.nombre || "cliente";
        var notas = (data.notas || "").trim() || "Sin notas adicionales.";
        var picante = data.picante || "Suave";

        // Recalcular para asegurar coherencia en mensaje
        actualizarResumen();

        statusEl.className = "status success";
        statusEl.textContent =
          "Pedido demo generado. As√≠ ver√≠as este pedido en tu WhatsApp o panel interno (incluye total y m√©todo de pago).";

        var pagoTxt = summaryPayment.textContent || "";
        var text =
          "üßæ *Nuevo pedido ‚Äì RESTAURANTE DEMO (ADD Orders)*\n\n" +
          "üë§ Nombre: " + nombre + "\n" +
          "üçΩ Pedido: " + cantidad + " x " + mData.nombre + "\n" +
          "üå∂ Picante: " + picante + "\n" +
          "‚ûï Extras: " + extrasText + "\n\n" +
          "üöö Modalidad: " + modalidad + "\n" +
          (data.modalidad === "delivery" ? "üìç Zona: " + zona + " (demo)\n" : "") +
          "‚è∞ Hora aproximada: " + hora + "\n" +
          "üì± WhatsApp contacto: " +
          (data.whatsapp && data.whatsapp.trim() ? data.whatsapp.trim() : "No especificado") +
          "\n\n" +
          "üíµ Subtotal comida: " + summarySubtotal.textContent + "\n" +
          "üöö Delivery: " + summaryDelivery.textContent + "\n" +
          "üíÅ Propina estimada: " + summaryTip.textContent + "\n" +
          "‚úÖ Total estimado: " + summaryTotal.textContent + "\n" +
          "üí≥ M√©todo de pago: " + pagoTxt + "\n\n" +
          "üìù Notas del cliente: " + notas + "\n\n" +
          "Este pedido llega estructurado desde *ADD Orders*: un solo mensaje claro para cobrar y pasar directo a cocina.";

        preview.textContent = text;

        // Paso 3 completado
        step3Completed = true;
        actualizarSteps();
      });
    }

    // Inicializar estado
    actualizarPlato();
    actualizarDeliveryVisibilidad();
    actualizarResumen();
  </script>
</body>
</html>
